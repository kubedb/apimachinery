syntax = "proto3";

package migrator;

import "google/protobuf/struct.proto";

option go_package = "kubedb.dev/apimachinery/apis/migrator/grpc/proto;migrator";

service MigrationService {
  rpc StreamMigrationProgress(GetProgressRequest)
      returns (stream MigrationProgress);

  rpc GetCurrentProgress(GetProgressRequest)
      returns (MigrationProgress);

  // DestroyMigration stops the migration monitor and cleans up resources
  rpc DestroyMigration(DestroyRequest)
      returns (DestroyResponse);
}

message GetProgressRequest {}

message MigrationProgress {
  // Database type: postgres / mongodb / mariadb
  string db_type = 1;
  google.protobuf.Struct details = 3;
}

message DestroyRequest {}

message DestroyResponse {
  bool success = 1;
  string message = 2;
}